JWT (json web token), stateless oturum yönetimlerinde kullanıcı doğrulamasında kullanılır. Verilen ipuçlarından JWT ile ilgili olduğunu anlayabiliriz. 

![](../../pics/Pasted%20image%2020230625165114.png)

Giriş sayfasına verilen kullanıcı bilgileri ile giriş yapalım. 
`username: test`
`password: Test123!`

![](../../pics/Pasted%20image%2020230625165416.png)

Giriş yaptıktan sonra görseldeki gibi bir sayfa ile karşılaşmaktayız. JWT ile ilgili olduğunu düşündüğüm için ilk olarak oturum çerezlerini kontrol ediyorum. 

![](../../pics/Pasted%20image%2020230625165638.png)

token değerini jwt debugger kullanarak çözümlüyorum.

![](../../pics/Pasted%20image%2020230625170609.png)

HS256 algoritması kullanılmış ve kullanıcı rolü 'user' olarak belirtilmiş test kullanıcısı için.

JWT ile ilgili zafiyetleri ve saldırıları araştırabiliriz. Bunun için kullandığım kaynak:

https://book.hacktricks.xyz/pentesting-web/hacking-jwt-json-web-tokens

Token algoritma değerini none yapbiliriz veya HMAC gizli anahtarı brute-force yöntemi ile keşfedebiliriz gibi yöntemleri sıraysıyla deneyelim.

İlk aşamada kolay olduğu için algoritma değerini değiştireceğim. Bundan öncesinde token payload içerisindeki role: user bölümünü role:admin olarak değiştirdim ve doğrulamayı gerçekleştiremedim.


![](../../pics/Pasted%20image%2020230625170707.png)

Token algoritma değeri "none" olarak değiştirip role:admin olarak belirttikten sonra oluşan token değerini kopyalayıp test kullanıcısının token değeriyle değiştirelim ve sayfayı yenileyelim.

![](../../pics/Pasted%20image%2020230625171008.png)

Kullanıcı admin olarak doğrulanmış oldu ve flag değeri sayda gösterilmektedir. 

Burada kullanılan CVE-2015-9235 numaralı güvenlik açığıdır. JWT token değerinin kullandığı algoritmayı değiştirerek token düzenlenebilmektedir. 


